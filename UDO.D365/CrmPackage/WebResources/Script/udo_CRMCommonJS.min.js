!function n(n,t,i){function r(u,e){var s,h,o;if(!t[u]){if(!n[u]){if(s="function"==typeof require&&require,!e&&s)return s(u,!0);if(f)return f(u,!0);h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h;}o=t[u]={exports:{}};n[u][0].call(o.exports,function(t){var i=n[u][1][t];return r(i?i:t)},o,o.exports,n,n,t,i)}return t[u].exports}for(var f="function"==typeof require&&require,u=0;u<i.length;u++)r(i[u]);return r}({1:[function(n,t){"use strict";function e(){}function a(n){try{return n.then}catch(t){return u=t,f}}function v(n,t){try{return n(t)}catch(i){return u=i,f}}function y(n,t,i){try{n(t,i)}catch(r){return u=r,f}}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._37=0;this._12=null;this._59=[];n!==e&&l(n,this)}function p(n,t,r){return new n.constructor(function(u,f){var s=new i(e);s.then(u,f);o(n,new c(t,r,s))})}function o(n,t){for(;3===n._37;)n=n._12;return 0===n._37?void n._59.push(t):void w(function(){var e=1===n._37?t.onFulfilled:t.onRejected,i;if(null===e)return void(1===n._37?s(t.promise,n._12):r(t.promise,n._12));i=v(e,n._12);i===f?r(t.promise,u):s(t.promise,i)})}function s(n,t){if(t===n)return r(n,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var e=a(t);if(e===f)return r(n,u);if(e===n.then&&t instanceof i)return n._37=3,n._12=t,void h(n);if("function"==typeof e)return void l(e.bind(t),n)}n._37=1;n._12=t;h(n)}function r(n,t){n._37=2;n._12=t;h(n)}function h(n){for(var t=0;t<n._59.length;t++)o(n,n._59[t]);n._59=null}function c(n,t,i){this.onFulfilled="function"==typeof n?n:null;this.onRejected="function"==typeof t?t:null;this.promise=i}function l(n,t){var i=!1,e=y(n,function(n){i||(i=!0,s(t,n))},function(n){i||(i=!0,r(t,n))});i||e!==f||(i=!0,r(t,u))}var w=n("asap/raw"),u=null,f={};t.exports=i;i._99=e;i.prototype.then=function(n,t){if(this.constructor!==i)return p(this,n,t);var r=new i(e);return o(this,new c(n,t,r)),r}},{"asap/raw":4}],2:[function(n,t){"use strict";function r(n){var t=new i(i._99);return t._37=1,t._12=n,t}var i=n("./core.js");t.exports=i;var u=r(!0),f=r(!1),e=r(null),o=r(void 0),s=r(0),h=r("");i.resolve=function(n){if(n instanceof i)return n;if(null===n)return e;if(void 0===n)return o;if(n===!0)return u;if(n===!1)return f;if(0===n)return s;if(""===n)return h;if("object"==typeof n||"function"==typeof n)try{var t=n.then;if("function"==typeof t)return new i(t.bind(n))}catch(c){return new i(function(n,t){t(c)})}return r(n)};i.all=function(n){var t=Array.prototype.slice.call(n);return new i(function(n,r){function u(f,o){var s,h;if(o&&("object"==typeof o||"function"==typeof o)){if(o instanceof i&&o.then===i.prototype.then){for(;3===o._37;)o=o._12;return 1===o._37?u(f,o._12):(2===o._37&&r(o._12),void o.then(function(n){u(f,n)},r))}if(s=o.then,"function"==typeof s)return h=new i(s.bind(o)),void h.then(function(n){u(f,n)},r)}t[f]=o;0==--e&&n(t)}if(0===t.length)return n([]);for(var e=t.length,f=0;f<t.length;f++)u(f,t[f])})};i.reject=function(n){return new i(function(t,i){i(n)})};i.race=function(n){return new i(function(t,r){n.forEach(function(n){i.resolve(n).then(t,r)})})};i.prototype["catch"]=function(n){return this.then(null,n)}},{"./core.js":1}],3:[function(n,t){"use strict";function o(){if(u.length)throw u.shift();}function r(n){var t;t=i.length?i.pop():new f;t.task=n;e(t)}function f(){this.task=null}var e=n("./raw"),i=[],u=[],s=e.makeRequestCallFromTimer(o);t.exports=r;f.prototype.call=function(){try{this.task.call()}catch(n){r.onerror?r.onerror(n):(u.push(n),s())}finally{this.task=null;i[i.length]=this}}},{"./raw":4}],4:[function(n,t){(function(n){"use strict";function u(n){i.length||(f(),s=!0);i[i.length]=n}function e(){for(var t,n,u;r<i.length;)if(t=r,r+=1,i[t].call(),r>l){for(n=0,u=i.length-r;u>n;n++)i[n]=i[n+r];i.length-=r;r=0}i.length=0;r=0;s=!1}function c(n){var t=1,r=new h(n),i=document.createTextNode("");return r.observe(i,{characterData:!0}),function(){t=-t;i.data=t}}function o(n){return function(){function t(){clearTimeout(i);clearInterval(r);n()}var i=setTimeout(t,0),r=setInterval(t,50)}}t.exports=u;var f,i=[],s=!1,r=0,l=1024,h=n.MutationObserver||n.WebKitMutationObserver;f="function"==typeof h?c(e):o(e);u.requestFlush=f;u.makeRequestCallFromTimer=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(n){setTimeout(function(){throw n;},0)})})},{}],6:[function(n){n("asap");"undefined"==typeof Promise&&(Promise=n("./lib/core.js"),n("./lib/es6-extensions.js"));n("./polyfill-done.js")},{"./lib/core.js":1,"./lib/es6-extensions.js":2,"./polyfill-done.js":5,asap:3}]},{},[6]);var CrmCommonJS;(function(n){var t=function(){function t(t,i){this.crmVersion=t;this.exCon=i;typeof Xrm=="undefined"&&(Xrm=window.parent.Xrm);var r=new n.ApiFactory(t,i);this.WebApi=r.GetWebApi(i);this.Security=r.GetSecurityApi(this.WebApi);this.Notification=r.GetNotificationApi();this.FormHelper=r.GetFormApi(i);this.Util=r.GetUtilApi()}return t}();n.CrmCommon=t})(CrmCommonJS||(CrmCommonJS={})),function(n){var t=function(){function t(n,t){this.crmVersion=n;this.exCon=t}return t.prototype.GetWebApi=function(){return this.crmVersion<2016?new n.ODataApi(this.crmVersion):new n.WebApi(this.crmVersion,this.exCon)},t.prototype.GetSecurityApi=function(t){return new n.Security(t)},t.prototype.GetFormApi=function(){return new n.FormHelper(this.exCon)},t.prototype.GetNotificationApi=function(){return new n.Notification},t.prototype.GetUtilApi=function(){return new n.Util},t}();n.ApiFactory=t}(CrmCommonJS||(CrmCommonJS={})),function(n){var t=function(){function n(t){n.exCon=t;n.formContext=n.prototype.GetFormContextOrDefault(t)}return n.prototype.GetFormContextOrDefault=function(n){return n?n.getFormContext():parent.Xrm?parent.Xrm.Page:Xrm.Page},n.prototype.getCurrentRecordIdFormatted=function(){var t=n.formContext.data.entity.getId();return t.replace(/{/gi,"").replace(/}/,"")},n.prototype.getCurrentRecordId=function(){return n.formContext.data.entity.getId()},n.prototype.getSelectedLookupIdFormatted=function(t){var i=n.prototype.getSelectedLookupId(t);return i===null?i:i.replace(/{/gi,"").replace(/}/,"")},n.prototype.getSelectedLookupId=function(t){var i=n.prototype.getSelectedLookup(t);return i?i.id:null},n.prototype.getSelectedLookup=function(t){var i=n.prototype.getValue(t);return i?i[0]:null},n.prototype.setSubmitMode=function(t,i){var r=n.prototype.getAttribute(t);if(r){switch(i){case!0:case"always":i="always";break;case"dirty":i="dirty";break;case"never":case!1:i="never";break;default:alert(i+" is an invalid submit mode. Pass 'always', 'dirty', 'never' or a boolean to this method");return}r.setSubmitMode(i)}},n.prototype.setFormNotification=function(t,i,r){i=i.toUpperCase();switch(i){case"ERROR":i="ERROR";break;case"WARNING":i="WARNING";break;case"INFO":i="INFO";break;default:alert("Invald notification level. Select 'ERROR', 'WARNING' or 'INFO'");return}n.formContext.ui.setFormNotification(t,i,r)},n.prototype.getTab=function(t){return t?n.formContext.ui.tabs.get(t):null},n.prototype.getControl=function(t){if(!t)return null;var i=n.formContext.getControl(t);return i=i?i:null,i||console.log("No control found for "+t),i},n.prototype.clearFormNotification=function(t){t&&n.formContext.ui.clearFormNotification(t)},n.prototype.setValue=function(t,i,r,u,f){f===void 0&&(f=!1);r!==null&&typeof r=="boolean"&&(f=r,r=null);r!==null&&u&&i&&typeof i=="string"&&(i=[{id:i,name:r,entityType:u}]);var e=n.prototype.getAttribute(t);e&&(e.getAttributeType()==="lookup"&&(i=[{id:i.Id,name:i.Name,entityType:i.LogicalName}]),e.setValue(i),f&&e.fireOnChange())},n.prototype.saveRecord=function(t){t!==!0&&(t=!1);n.formContext.data.entity.save(t)},n.prototype.refreshRecord=function(){n.formContext.data.refresh()},n.prototype.getEntityLogicalName=function(){return n.formContext.data.entity.getEntityName()},n.prototype.getAttribute=function(t){if(!t)return null;var i=n.formContext.getAttribute(t);return i?i:null},n.prototype.getValue=function(t){var i=n.prototype.getAttribute(t);return i?i.getValue():null},n.prototype.SetLookupValue=function(n,t,i,r){if(n!==null){var u=[];u[0]={};u[0].id=t;u[0].name=i;u[0].entityType=r;formContext.getAttribute(n).setValue(u);formContext.getAttribute(n).setSubmitMode("always")}},n.prototype.SetFieldVisibility=function(n,t){var i=formContext.get(n);i!==null&&i.setVisible(t)},n.prototype.SetFieldReadOnly=function(n,t){var i=formContext.get(n);i!==null&&i.setDisabled(t)},n.prototype.SetTabVisibility=function(n,t){var i=formContext.ui.tabs.get(n);i!==null&&i.setVisible(t)},n.prototype.GetContext=function(){this.formContext=formContext;this.executionContext=executionContext},n}();n.FormHelper=t}(CrmCommonJS||(CrmCommonJS={})),function(n){var t=function(){function n(){this._ids=[];this._idc=1}return n.prototype.SetInfo=function(n,t){t===void 0&&(t=null);this._AddNotification(n,"INFO",t)},n.prototype.SetWarning=function(n,t){t===void 0&&(t=null);this._AddNotification(n,"WARNING",t)},n.prototype.SetError=function(n,t){t===void 0&&(t=null);this._AddNotification(n,"ERROR",t)},n.prototype.ClearNotification=function(n){if(n===void 0&&(n=null),n===null)this._ClearAllNotifications();else{Xrm.Page.ui.clearFormNotification(n);var t=this._ids.indexOf(n);t>-1&&this._ids.splice(t,1)}},n.prototype._AddNotification=function(n,t,i){i===null&&(i=this._idc.toString(),++this._idc);Xrm.Page.ui.setFormNotification(n,t,i);this._ids.push(i)},n.prototype._ClearAllNotifications=function(){this._ids.forEach(function(n){Xrm.Page.ui.clearFormNotification(n)});this._ids=[]},n}();n.Notification=t}(CrmCommonJS||(CrmCommonJS={})),function(n){var t=function(){function t(t){this.CrmVersion=t;this._util=new n.Util;this._clientUrl=Xrm.Page.context.getClientUrl();this.ODataEntityName={Role:"RoleSet",Team:"TeamSet",TeamMembership:"TeamMembershipSet"}}return t.prototype._MakeRequest=function(n,t,i){return i===void 0&&(i=null),new Promise(function(r,u){var f=new XMLHttpRequest;f.open(n,encodeURI(t),!0);f.setRequestHeader("Accept","application/json");f.setRequestHeader("Content-Type","application/json; charset=utf-8");f.onreadystatechange=function(){f.readyState===4&&(f.status>=200&&f.status<300?(f.onreadystatechange=null,r(f)):u(new Error(f.status+" - "+f.statusText)))};f.onerror=function(){u(new Error(f.status+" - "+f.statusText))};typeof i!="undefined"?f.send(JSON.stringify(i)):f.send(null)})},t.prototype._GetUrl=function(n,t,i){t===void 0&&(t=null);var r=this._clientUrl+"/XRMServices/2011/OrganizationData.svc/"+n;return t!==null&&typeof t!="undefined"&&(t=t.toString().replace("{","").replace("}",""),r=r+"(guid'"+t+"')"),i!==null&&typeof i!="undefined"&&(r=r+i),r},t.prototype.GetClientUrl=function(){return this._clientUrl},t.prototype.RetrieveRecord=function(n,t,i,r){var u=this;return r===void 0&&(r=null),new Promise(function(f,e){var o,s;if(n===null||typeof n=="undefined")return e(new Error("RetrieveRecord error: guid is null"));if(t===null||typeof t=="undefined")return e(new Error("RetrieveRecord error: entityType is null"));o=null;i!==null&&typeof i!="undefined"&&(o="?$select="+i);r!==null&&typeof r!="undefined"&&(o===null?o="?"+r:o+="&"+r);s=u._GetUrl(t,n,o);console.log(s);u._MakeRequest("GET",s).then(function(n){var t=JSON.parse(n.response);f(t.d)}).catch(function(n){console.log("Error during RetrieveRecord MakeRequest (Legacy): "+n);e(new Error(n))})})},t.prototype.RetrieveMultiple=function(n,t,i){var r=this;return new Promise(function(u,f){var e,o;if(n===null||typeof n=="undefined")return f(new Error("RetrieveMultiple error: entityType is null"));e=null;t!==null&&typeof t!="undefined"&&(e="?$select="+t);i!==null&&typeof i!="undefined"&&(e===null?e="?"+i:e+="&"+i);o=r._GetUrl(n,null,e);console.log(o);r._MakeRequest("GET",o).then(function(n){var t=JSON.parse(n.response);u(t)}).catch(function(n){console.log("Error during RetrieveMultiple MakeRequest: "+n);f(new Error(n))})})},t.prototype.CreateRecord=function(){return new Promise(function(){})},t.prototype.DeleteRecord=function(){return new Promise(function(){})},t.prototype.DeleteProperty=function(){return new Promise(function(){})},t.prototype.UpdateRecord=function(){return new Promise(function(){})},t.prototype.PutRecord=function(){return new Promise(function(){})},t.prototype.ExecuteRequest=function(){return new Promise(function(){})},t.prototype.SetLookupValue=function(){return null},t}();n.ODataApi=t}(CrmCommonJS||(CrmCommonJS={})),function(n){var t=function(){function n(n){this._roleGuids=Xrm.Page.context.getUserRoles();this._userTeamNames=[];this._webApi=n}return n.prototype._GetUsersTeamIds=function(){var n=this;return new Promise(function(t,i){var r=Xrm.Page.context.getUserId().substr(1,36);n._webApi.RetrieveMultiple(n._webApi.ODataEntityName.TeamMembership,"teamid","$filter=systemuserid eq "+r).then(function(n){t(n)}).catch(function(n){i(new Error(n))})})},n.prototype._GetUsersTeamNames=function(){var n=this;return new Promise(function(t,i){if(n._userTeamNames.length>0)return t(n._userTeamNames);n._GetUsersTeamIds().then(function(t){return Promise.all(t.value.map(function(t){return n._webApi.RetrieveRecord(t.teamid,n._webApi.ODataEntityName.Team,"name")}))}).then(function(i){i.forEach(function(t){n._userTeamNames.push(t.name)});t(n._userTeamNames)}).catch(function(n){console.log("Error during GetUsersTeamNames: "+n);i(new Error(n))})})},n.prototype.GetUsersRoleNames=function(){var n=this;return new Promise(function(t,i){var r=[];Promise.resolve(n._roleGuids).then(function(t){return Promise.all(t.map(function(t){return n._webApi.RetrieveRecord(t,n._webApi.ODataEntityName.Role,"name")}))}).then(function(n){n.forEach(function(n){r.push(n.name)});t(r)}).catch(function(n){console.log("Error during GetUsersRoleNames: "+n);i(new Error(n))})})},n.prototype.GetUsersTeamNames=function(){return this._GetUsersTeamNames()},n.prototype.UserHasRole=function(n){var t=this;return new Promise(function(i,r){if(n===null||typeof n=="undefined")return r(new Error("Error in UserHasRole: roleNames is null"));t.GetUsersRoleNames().then(function(t){for(var f=n.length,u=!1,r=0;r<f;++r)if(t.indexOf(n[r])>-1){u=!0;break}i(u)}).catch(function(n){console.log("Error in UserHasRole: "+n);r(new Error(n))})})},n.prototype.IsUserInTeam=function(n){var t=this;return new Promise(function(i,r){if(n===null||typeof n=="undefined")return r(new Error("Error in IsUserInTeam: teamName is null"));t._GetUsersTeamNames().then(function(t){i(t.indexOf(n)>-1)}).catch(function(n){console.log("Error in IsUserInTeam: "+n);r(new Error(n))})})},n.prototype.UserHasPrivilege=function(n){var t=this;return new Promise(function(i,r){var u=t._webApi,f=null;return u.RetrieveMultiple("privileges","name,privilegeid","$filter=name eq '"+n+"'").then(function(t){if(t===null||t.value===null||typeof t.value=="undefined"||t.value[0]===null)return r(new Error("UserHasPrivilege: could not find privilege "+n));f=t.value[0].privilegeid;var i=Xrm.Page.context.getUserId().replace("{","").replace("}","");return u.ExecuteRequest("GET","systemusers("+i+")/Microsoft.Dynamics.CRM.RetrieveUserPrivileges")}).then(function(n){for(var r=!1,t=0;t<n.RolePrivileges.length;++t)if(n.RolePrivileges[t].PrivilegeId===f){r=!0;break}i(r)}).catch(function(n){console.log("Error in UserHasPrivilege: "+n.message)})})},n}();n.Security=t}(CrmCommonJS||(CrmCommonJS={})),function(n){var t=function(){function n(){}return n.prototype.GetQueryString=function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(window.location.href);return t===null?null:t[1]},n.prototype.GetQueryStringKey=function(n,t){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp(n+"=([^&#]*)"),i=r.exec(t);return i===null?null:i[1]},n.prototype.GetQueryStringParameterByName=function(n){var r=window.location.href,i,t;return(n=n.replace(/[\[\]]/g,"\\$&"),i=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),t=i.exec(r),!t)?null:t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):""},n.prototype.CapitalizeFirst=function(n){return n!==null?n.charAt(0).toUpperCase()+n.slice(1):null},n.FormatLongDate=function(n){var i=n.replace(")/",""),t=new Date(parseInt(i,10));return t.getUTCFullYear()+"-"+(t.getUTCMonth()+1)+"-"+t.getUTCDate()},n.FormatShortDate=function(n){var i=n.replace(")/",""),t=new Date(parseInt(i,10));return t.getUTCDate()+"/"+(t.getUTCMonth()+1)+"/"+t.getUTCFullYear()},n}();n.Util=t}(CrmCommonJS||(CrmCommonJS={})),function(n){var i=function(){function n(n){this.CrmVersion=n;this._apiVersion="v9.0";this._clientUrl=Xrm.Page.context.getClientUrl();this._requestHeaders=[];this.ODataEntityName={Role:"roles",Team:"teams",TeamMembership:"teammemberships"}}return n.prototype._GetUrl=function(n,t,i){t===void 0&&(t=null);i===void 0&&(i=null);var r=this._clientUrl+"/api/data/"+this._apiVersion+"/"+n;return t!==null&&typeof t!="undefined"&&(t=t.toString().replace("{","").replace("}",""),r=r+"("+t+")"),i!==null&&typeof i!="undefined"&&(r=r+i),r},n.prototype.GetClientUrl=function(){return this._clientUrl},n.prototype.AddRequestHeader=function(n,i){this._requestHeaders.push(new t(n,i))},n.prototype.CreateRecord=function(n,t){return new Promise(function(i,r){if(n===null||typeof n=="undefined")return r("CreateRecord error: entity is null");if(t===null||typeof t=="undefined")return r("CreateRecord error: entityType is null");Xrm.WebApi.createRecord(t,n).then(function(n){var t=n;t!==null&&i(t);r("Could not find GUID on create")}).catch(function(n){r(new Error("Error during CreateRecord MakeRequest: "+n))})})},n.prototype.DeleteRecord=function(n,t){return new Promise(function(i,r){if(n===null||typeof n=="undefined")return r("DeleteRecord error: guid is null");if(t===null||typeof t=="undefined")return r("DeleteRecord error: entityType is null");Xrm.WebApi.deleteRecord(t,n).then(function(){console.log("DELETE OK - "+n);i(!0)}).catch(function(t){console.log("Error during DELETE of guid "+n);r(new Error(t))})})},n.prototype.UpdateRecord=function(n,t,i){return new Promise(function(r,u){if(n===null||typeof n=="undefined")return u(new Error("UpdateRecord error: guid is null"));if(t===null||typeof t=="undefined")return u(new Error("UpdateRecord error: entityType is null"));if(i===null||typeof i=="undefined")return u(new Error("UpdateRecord error: entity is null"));Xrm.WebApi.updateRecord(t,n,i).then(function(){console.log("UPDATE OK - "+n);r(n)}).catch(function(t){console.log("Error: "+t+" during UPDATE of guid "+n);u(new Error(t))})})},n.prototype.RetrieveRecord=function(n,t,i){return new Promise(function(r,u){if(n===null||typeof n=="undefined")return u(new Error("RetrieveRecord error: guid is null"));if(n=n.replace(/{/gi,"").replace(/}/gi,""),t===null||typeof t=="undefined")return u(new Error("RetrieveRecord error: entityType is null"));var f=null;i!==null&&typeof i!="undefined"&&(f="?$select="+i.join(","));Xrm.WebApi.retrieveRecord(t,n,f).then(function(n){return r(n)},function(n){return u(new Error(n))})})},n.prototype.RetrieveMultiple=function(t,i,r){return new Promise(function(u,f){var e,o;(t===null||typeof t=="undefined")&&f(new Error("RetrieveMultiple error: entityType is null"));e=null;i!==null&&typeof i!="undefined"&&(e="?$select="+i.join(","));r!==null&&typeof r!="undefined"&&(e===null?e="?"+r:e+="&"+r);o=[];o=n.prototype.doRetrieve(t,e,o);u(o)})},n.prototype.doRetrieve=function(t,i,r){return new Promise(function(u,f){Xrm.WebApi.retrieveMultipleRecords(t,i).then(function(i){if(r=r.concat(i.entities),i.nextLink!==undefined){console.log(i.nextLink.length);var f=i.nextLink.substring(i.nextLink.indexOf("?"),i.nextLink.length);r=n.prototype.doRetrieve(t,f,r)}u(r)},function(n){f(n)})})},n.prototype.RetrieveByFetchXml=function(n,t){return new Promise(function(i,r){if(t===null||typeof t=="undefined")return r(new Error("RetrieveByFetchXml error: fetchXml is null"));if(n===null||typeof n=="undefined")return r(new Error("RetrieveByFetchXml error: entityType is null"));var u="?fetchXml"+encodeURIComponent(t);Xrm.WebApi.RetrieveMultipleRecords(n,u,null).then(function(n){i(n)}).catch(function(n){console.log("Error during RetrieveByFetchXml MakeRequest: "+n);r(new Error(n))})})},n.prototype.executeAction=function(n){return new Promise(function(t,i){Xrm.WebApi.execute(n).then(function(n){return t(n)},function(n){return i(new Error(n))})})},n.prototype.ExecuteRequest=function(n,t){return new Promise(function(i,r){if(n===null||typeof n=="undefined")return r(new Error("ExecuteRequest error: metaData is null"));var u=new RequestObj(n,t);Xrm.WebApi.execute(u).then(function(t){console.log("EXECUTE "+n._operationName+" - OK");t.response!==""?i(t):i(null)}).catch(function(t){console.log("Error: during EXECUTE "+n._operationName+": "+t);r(new Error(t))})})},n.prototype.RequestObj=function(n,t){$.each(t,function(n,t){this.parameter.key=t.value});this.getMetadata=function(){var t={boundParameter:n.boundParameter,operationName:n.operationName,operationType:n.operationType};return $.each(n.parameterTypes,function(n,i){t.parameterTypes+=i}),t}},n.prototype.SetLookupValue=function(n,t){return this._GetUrl(t,n)},n.prototype.PromiseTimeout=function(n,t){return new Promise(function(i,r){var u=setTimeout(function(){r(new Error("timeout"))},n);t.then(function(n){clearTimeout(u);i(n)}).catch(function(n){clearTimeout(u);r(n)})})},n}(),t;n.WebApi=i;t=function(){function n(n,t){this.key=n;this.value=t}return n}()}(CrmCommonJS||(CrmCommonJS={}));