function RetrieveAnnouncements(){var n=new Date,r=document.documentMode,t,i;if(r<9){alert("The web browser version is incompatible and cannot query for Announcements.");console.log("Document mode is: "+document.documentMode);return}n=n.toISOString();t=["udo_body","udo_expirationdate","udo_name","udo_priority","statecode"];i="$filter=statecode eq 0 and udo_expirationdate ge ("+n+") or statecode eq 0 and udo_expirationdate eq null&$orderby=udo_priority asc";ExecuteQuery(t,i)}function ExecuteQuery(n,t){var r=GetGlobalContext(),i=r.getClientUrl();i.match(/\/$/)&&(i=i.substring(0,i.length-1));webApi.RetrieveMultiple("udo_announcement",n,t).then(function(n){var s=document.getElementById("announcementsTableBody"),h,i,r,u,f,t,o,e;if(n===null||n.length===0)r=s.insertRow(0),u=r.insertCell(0),u.setAttribute("SCOPE","row"),f=r.insertCell(1),f.setAttribute("SCOPE","row"),t="There are currently no Announcements.",e="inputAnnouncement_0",focusAnnouncement=e,u.innerHTML='<img alt="Announcement Icon" src="udo_/Images/Announcement.png" />',f.innerHTML='<div class="header"><input type="input" name="'+e+'" style="font-size:14px;font-weight: bold;border: none;" readonly="readonly" size="'+t.length+'" value="'+t+'" aria-label="'+t+'" /><\/div>';else for(h=0,i=n.length-1;i>=0;i--)r=s.insertRow(0),u=r.insertCell(0),u.setAttribute("SCOPE","row"),f=r.insertCell(1),f.setAttribute("SCOPE","row"),t=n[i].udo_name,o=n[i].udo_body,o.toLowerCase().indexOf("<\/html>")===-1&&(o=o.replace(/(\r\n|\n|\r)/gm,"<br>")),e="inputAnnouncement_"+i.toString(),i===0&&(focusAnnouncement=e),u.innerHTML='<img alt="Announcement Icon" src="udo_/Images/Announcement.png" />',f.innerHTML='<div class="header"><input type="input" name="'+e+'" style="font-size:14px;font-weight: bold;border: none;" readonly="readonly" size="'+t.length+'" value="'+t+'" aria-label="Announcement - '+t+o+'" /><\/div><div class="body">'+o+"<\/div>",h++;getFocus()},function(n){console.log(n)})}function getFocus(){document.forms.announcementForm.elements[focusAnnouncement].focus()}var focusAnnouncement,globalContext=Xrm.Utility.getGlobalContext(),version=globalContext.getVersion(),lib=new CrmCommonJS.CrmCommon(version,null),webApi=lib.WebApi;window.ENTITY_SET_NAMES=window.ENTITY_SET_NAMES||JSON.stringify({udo_announcement:"udo_announcements"});window.onload=RetrieveAnnouncements;