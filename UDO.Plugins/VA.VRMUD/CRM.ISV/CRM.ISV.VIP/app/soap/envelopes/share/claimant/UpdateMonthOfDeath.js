//VERY COMPLEX.. TO DO LATER